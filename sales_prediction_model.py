# -*- coding: utf-8 -*-
"""Sales Prediction Model.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/133j46W53eF0XDKywnKyqdM8Ni05U0S5P
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

data=pd.read_csv('/content/advertising.csv')
data.head()

data.shape

data.info()

data.isnull().sum()

data.duplicated().sum()

data.describe()

sns.pairplot(data,x_vars=['TV','Radio','Newspaper'],y_vars='Sales',kind='scatter')
plt.show()

data.corr()

sns.heatmap(data.corr(),cmap='YlGn',annot=True,annot_kws={'size':10})

data['TV'].plot.hist(bins=10)

x=data['TV']
y=data['Sales']

x.info()

y.info()

from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2)

print(type(x_train))
print(type(x_test))
print(type(y_train))
print(type(y_test))

print(x.shape,x_train.shape,x_test.shape)

x_train=x_train.to_frame()
x_test=x_test.to_frame()

print(x_train.shape,x_test.shape)

print(type(x_train))
print(type(x_test))

from sklearn.linear_model import LinearRegression
model=LinearRegression()

model.fit(x_train,y_train)

from sklearn.metrics import accuracy_score
x_train_pred=model.predict(x_train)
print(x_train_pred)

from sklearn.metrics import mean_squared_error
mse=mean_squared_error(x_train_pred,y_train)
print(mse)

from sklearn.metrics import r2_score
r2=r2_score(x_train_pred,y_train)
print(r2)

x_test_pred=model.predict(x_test)
print(x_test_pred)

mse1=mean_squared_error(x_test_pred,y_test)
print(mse1)

r2=r2_score(x_test_pred,y_test)
print(r2)

import warnings
warnings.filterwarnings('ignore')

prediction=model.predict([[149]])
print('The predicted amount of sales is: ', prediction)